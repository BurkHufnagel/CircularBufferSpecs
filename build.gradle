buildscript {
	repositories {
		mavenCentral()
        jcenter()
	}
}

apply plugin: 'java'
apply plugin: 'groovy'
apply plugin: 'eclipse'
apply plugin: 'idea'


group = 'com.deliverbettersoftwarefaster.tdd'
version = '0.0.1-SNAPSHOT'
sourceCompatibility = 1.8


ext {
	ext {
		groovyVersion = '2.4.125'
	}
}


repositories {
	mavenCentral()
}


dependencies {
    // Test dependencies (Spock)
	testCompile "org.codehaus.groovy:groovy-all:2.5.7"
	testCompile "org.spockframework:spock-core:1.3-groovy-2.5"
    testCompile 'com.athaydes:spock-reports:1.3.1'
}


test {
    enabled = true

    maxHeapSize = "1g"
    jvmArgs '-XX:MaxMetaspaceSize=128m'
    testLogging {
        exceptionFormat = 'full'
    }
}


// Might be able to move this into functionalTest
tasks.withType(GroovyCompile) {
    groovyOptions.forkOptions.memoryMaximumSize = '256m'
}


// Unit tests should be run every time we build.
build.dependsOn test


tasks.withType(Test) {
	reports.html.destination = file("${reporting.baseDir}/${name}")

	systemProperty "env", System.getProperty("env") // Useful for passing environment variables to the app
}


